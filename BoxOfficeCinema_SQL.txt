
#create database
create database Blockbuster_Cinema;

#start using database
use Blockbuster_Cinema;

#create tables
CREATE TABLE MOVIE_DETAILS (
MOVIE_ID INT PRIMARY KEY,
MOVIE_NAME VARCHAR(50),
MOVIE_DURATION_MINS INT,
SILVER_TICKET_COST INT,
GOLD_TICKET_COST INT,
BOX_OFFICE_TICKET_COST INT,
DRIVE_IN_TICKET_COST INT);

CREATE TABLE SCREEN_DETAILS ( 
SCREEN_NO INT NOT NULL PRIMARY KEY,
SILVER_TOT_CAPACITY INT,
GOLD_TOT_CAPACITY INT,
BOX_OFFICE_TOT_CAPACITY INT,
DRIVE_IN_TYPE CHAR(3) NOT NULL,
DRIVE_IN_TOT_CAPACITY INT);

CREATE TABLE SHOW_DETAILS (
SCREEN_NO INT,
FOREIGN KEY (SCREEN_NO) REFERENCES SCREEN_DETAILS (SCREEN_NO),
MOVIE_ID INT REFERENCES MOVIE_DETAILS (MOVIE_ID),
FOREIGN KEY (MOVIE_ID) REFERENCES MOVIE_DETAILS (MOVIE_ID),
NO_OF_SHOWS INT);

CREATE TABLE SHOW_TIME_DETAILS (
SHOW_TIME_ID INT PRIMARY KEY,
MOVIE_ID INT,
FOREIGN KEY (MOVIE_ID) REFERENCES MOVIE_DETAILS (MOVIE_ID),
START_HH INT,
START_MIN INT);

CREATE TABLE SCREEN_BOOKING (
SCREEN_NO INT,
FOREIGN KEY (SCREEN_NO) REFERENCES SCREEN_DETAILS (SCREEN_NO),
SHOW_TIME_ID INT,
FOREIGN KEY (SHOW_TIME_ID) REFERENCES SHOW_TIME_DETAILS (SHOW_TIME_ID),
SILVER_TICKETS_BOOKED INT,
GOLD_TICKETS_BOOKED INT,
BOX_OFFICE_TICKETS_BOOKED INT,
DRIVE_IN_TICKETS_BOOKED INT,
BOOKING_DATE DATE);

ALTER TABLE SCREEN_BOOKING add PRIMARY KEY (SCREEN_NO, BOOKING_DATE);

CREATE TABLE CUST_BOOKING (
BOOKING_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(50),
CUST_PHONE CHAR(10),
NO_TICKETS_BOOKED INT,
MOVIE_ID INT,
FOREIGN KEY(MOVIE_ID) REFERENCES MOVIE_DETAILS (MOVIE_ID),
SHOW_TIME_ID INT,
FOREIGN KEY(SHOW_TIME_ID) REFERENCES SHOW_TIME_DETAILS (SHOW_TIME_ID),
BOOKING_DATE DATE);

CREATE TABLE TICKET_NUMBER_BOOKING(
BOOKING_ID INT,
FOREIGN KEY(BOOKING_ID) REFERENCES CUST_BOOKING(BOOKING_ID),
TICKET_NO CHAR(3));

#add movie details 
INSERT INTO MOVIE_DETAILS VALUES (1, "Avatar: The Way Of Water", 190, 200, 400, 600, 1400);
INSERT INTO MOVIE_DETAILS VALUES (2, "Drishyam-2", 145, 150, 300, 450, 1400);
INSERT INTO MOVIE_DETAILS VALUES (3, "Minions: The Rise of Gru", 88, 100, 200, 300, 1000);

#add screen details
INSERT INTO SCREEN_DETAILS VALUES (1, 50, 30, 20, "no", NULL); 
INSERT INTO SCREEN_DETAILS VALUES (2, 70, 40, 30, "no", NULL);
INSERT INTO SCREEN_DETAILS VALUES (3, NULL, NULL, NULL, "yes", 30);

#add show details. show starts at 9 AM .
#screen 1 is running "Drishyam-2", 5 shows
INSERT INTO SHOW_DETAILS VALUES (1, 2, 5); 

#screen 2 is running "Avatar", 4 shows
INSERT INTO SHOW_DETAILS VALUES (2, 1, 4); 

#screen 3 is running "Minions", 7 shows
INSERT INTO SHOW_DETAILS VALUES (3, 3, 7); 

#add show timings, "drishyam" at 09:00, 12:00, 15:00, 18:00, 21:00
INSERT INTO SHOW_TIME_DETAILS VALUES (1, 2, 09, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (2, 2, 12, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (3, 2, 15, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (4, 2, 18, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (5, 2, 21, 00); 
#add show timings, "avatar" at 09:00, 13:00, 17:00, 21:00
INSERT INTO SHOW_TIME_DETAILS VALUES (6, 1, 09, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (7, 1, 13, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (8, 1, 17, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (9, 1, 21, 00);
#add show timings, "minions" at 9, 11, 13, 15, 17, 19, 21
INSERT INTO SHOW_TIME_DETAILS VALUES (10, 3, 09, 00); 
INSERT INTO SHOW_TIME_DETAILS VALUES (11, 3, 11, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (12, 3, 13, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (13, 3, 15, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (14, 3, 17, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (15, 3, 19, 00);
INSERT INTO SHOW_TIME_DETAILS VALUES (16, 3, 21, 00);
